const a11_0x1099=["_blendModeOption","type","_color","lighten","width","_svgInnerLine","round","linearDodgeAdd","line","textContent","value","_getLine","normal","toString","render","backgroundColor","#00000080","_cursorInfo","block","_model","display","1085715zhsBdw","pointerMove","462772jQrkyT","style","_setPixel","29KiVcfx","_imageService","onRequestRender","string","_isPointerDown","_getLineLow","removeChild","webpackChunkluna","_drawLine","fire","_lastDownCoord","_outlineElementContainer","linearBurn","_onHistoryUpdateValue","zoom","length","_updateCursorInfo","marginLeft","onUndo","_onUpdate","pointerDown","isVisible","offsetX","_onRequestRender","233654OkcTsG","2px","paletteService","currentLayer","height","_container","_isShiftDown","position","_value","_outlineModel","createExtendedEdit","push","_cursorCoord","createDomRenderProgram","historyService","_sc","pointerUp","0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);","commit","_plotLineLow","appendChild","name","_svg","getColorFromPointerEvent","_svgLine","strokeWidth","isValid","outline","_hideCursorInfo","multiply","12445ARLAmV","1px solid #000","opacity","_getOutlineElement","_ignoreSetPixel","pencil","top","number","205sAjrhz","_updateOutline","boxShadow","0.5","keyUp","_edit","register","_lastUpCoords","viewportService","setValueFromHistoryChange","exclusion","stroke","clientHeight","classList","min","replace","max","6508TxsLoQ","14857mRddFF","_element","overlay","clientWidth","containsCoord","_getEdit","http://www.w3.org/2000/svg","difference","order","lineHeight","imageService","left","_viewportService","#fff","darken","_getLineHigh","140ohUQwU","Blend Mode","event","requestRender","createElement","operationName","20px","none","options","_plotLineHigh","_plotLine","border","screen","abs","onHistoryUpdateValue","zIndex","onUpdate","absolute","_outlineElements","Pencil","div","933270UOlFIZ","3vpyllo","getCoordsFromEvent","createElementNS","text","setAttribute","softLight","shiftKey"],a11_0x5fed=function(t,s){return a11_0x1099[t-=101]},a11_0x30b744=a11_0x5fed;(function(t,s){const i=a11_0x5fed;for(;;)try{if(941782===parseInt(i(201))*parseInt(i(184))+-parseInt(i(240))*parseInt(i(146))+parseInt(i(117))+parseInt(i(239))+parseInt(i(122))*-parseInt(i(202))+parseInt(i(119))+parseInt(i(218))*-parseInt(i(176)))break;t.push(t.shift())}catch(s){t.push(t.shift())}})(a11_0x1099),(self.webpackChunkluna=self[a11_0x30b744(129)]||[])[a11_0x30b744(157)]([[518],{9904:(t,s,i)=>{"use strict";const e=a11_0x30b744;i.d(s,{rP:()=>n,bG:()=>r,Jp:()=>l,qv:()=>c});var o=i(1815),h=i(5120);class n extends h.JT{constructor(t,s,i){const e=a11_0x5fed;super(),this[e(167)]=t,this[e(226)]=s,this[e(154)]=i,this[e(248)]=e(125),this._onHistoryUpdateValue=this[e(190)](new o.v),this[e(232)]=this[e(135)][e(220)],this._onUpdate=this[e(190)](new o.v),this[e(234)]=this._onUpdate[e(220)]}get[e(106)](){return this[e(154)]}set value(t){const s=e;this[s(154)]=t,this[s(141)][s(131)]()}[e(193)](t){const s=e;this[s(154)]=t,this._onHistoryUpdateValue[s(131)](t)}}class r extends n{constructor(){const t=e;super(t(219),[t(108),t(216),t(175),"linearBurn","lighten",t(230),t(103),t(204),"softLight",t(209),"exclusion"],t(108))}}class l extends n{constructor(){const t=e;super("Blend Mode",[t(108),t(199),"darken",t(175),t(134),t(250),"screen",t(103),t(204),t(245),"difference",t(194)],"normal")}}class c extends h.JT{constructor(t,s,i,h){const n=e;super(),this[n(167)]=t,this[n(154)]=s,this[n(198)]=i,this[n(200)]=h,this[n(248)]=n(183),this._onHistoryUpdateValue=this[n(190)](new o.v),this[n(232)]=this._onHistoryUpdateValue[n(220)],this[n(141)]=this[n(190)](new o.v),this[n(234)]=this[n(141)][n(220)]}get value(){return this[e(154)]}set[e(106)](t){const s=e;this._value=t,this[s(141)][s(131)]()}setValueFromHistoryChange(t){const s=e;this[s(154)]=t,this._onHistoryUpdateValue[s(131)](t)}}},3518:(t,s,i)=>{"use strict";const e=a11_0x30b744;i.r(s),i.d(s,{default:()=>_});var o=i(1815),h=i(5120);class n extends h.JT{constructor(t,s){const i=a11_0x5fed;super(),this[i(151)]=t,this._model=s,this.order=2,this[i(203)]=document[i(222)](i(238)),this[i(203)][i(120)].position=i(235),this[i(203)][i(120)][i(111)]=i(112),this[i(203)].style[i(229)]=i(177),this[i(203)].style[i(186)]=i(163),this[i(203)][i(120)].padding=i(147),this[i(203)][i(120)].height=i(224),this._element[i(120)][i(211)]=i(224),this[i(203)][i(120)][i(139)]=i(224),this._element[i(120)][i(233)]="1",this[i(203)].style[i(116)]=i(225),this[i(151)][i(166)](this[i(203)]),this[i(190)]({dispose:()=>this[i(151)][i(128)](this[i(203)])})}[e(110)](){const t=e;this[t(203)][t(120)][t(116)]=this._model[t(143)]?t(114):t(225),this[t(203)][t(120)][t(213)]=this[t(115)].x+"px",this[t(203)][t(120)][t(182)]=this[t(115)].y+"px",this[t(203)][t(105)]=this._model[t(243)]}}var r=i(1674);class l extends h.JT{constructor(t,s,i,o){const h=e;super(),this._container=t,this[h(123)]=s,this[h(214)]=i,this[h(115)]=o,this[h(210)]=2,this[h(236)]=[],this[h(133)]=document[h(222)]("div"),this[h(151)][h(166)](this[h(133)]),this._svg=document[h(242)](r.q,"svg"),this[h(170)]=document.createElementNS(r.q,h(104)),this[h(170)][h(120)][h(195)]=h(215),this[h(170)][h(120)].strokeWidth="2",this._svgLine[h(120)][h(178)]=h(187),this[h(101)]=document[h(242)](r.q,"line"),this._svgInnerLine[h(120)][h(195)]="#000",this._svgInnerLine[h(120)][h(171)]="1",this[h(101)][h(120)].opacity=h(187),this[h(168)].append(this[h(170)],this[h(101)]),this._container[h(166)](this[h(168)]),this[h(190)]({dispose:()=>{const t=h;this._container.removeChild(this._outlineElementContainer),this._container[t(128)](this[t(168)])}})}[e(110)](){const t=e,s=this[t(214)],i=this[t(123)][t(149)];if(!this._model[t(172)]||!i)return this[t(133)][t(120)].display=t(225),void(this[t(168)][t(120)][t(116)]=t(225));if(s[t(136)]<4){if(this[t(133)][t(120)][t(116)]=t(225),this[t(168)][t(120)][t(116)]=t(114),i){const e=Math[t(102)](this[t(151)][t(205)]/2)-i[t(251)]/2*s[t(136)]+s.x*s[t(136)],o=Math[t(102)](this[t(151)][t(196)]/2)-i[t(150)]/2*s[t(136)]+s.y*s.zoom,h=(e+(this._model.x1+.5)*s.zoom)[t(109)](),n=(o+(this[t(115)].y1+.5)*s.zoom)[t(109)](),r=(e+(this._model.x2+.5)*s[t(136)])[t(109)](),l=(o+(this[t(115)].y2+.5)*s.zoom)[t(109)]();this._svg[t(244)](t(251),this[t(151)][t(205)].toString()),this[t(168)][t(244)](t(150),this[t(151)].clientHeight.toString()),this._svgLine.setAttribute("x1",h),this[t(170)][t(244)]("y1",n),this[t(170)][t(244)]("x2",r),this[t(170)][t(244)]("y2",l),this._svgInnerLine.setAttribute("x1",h),this[t(101)][t(244)]("y1",n),this[t(101)].setAttribute("x2",r),this[t(101)].setAttribute("y2",l)}return}this._outlineElementContainer[t(120)][t(116)]=t(114),this[t(168)].style[t(116)]=t(225);const o=this[t(107)](this[t(115)].x1,this._model.y1,this[t(115)].x2,this._model.y2),h=[];let n=0;for(;n<o[t(137)]-1;n++){const s=o[n];let i=n;if(s[0]===o[i+1][0]){for(;i+1<o.length&&s[0]===o[i+1][0];)i++;h[t(157)]([s[0],s[1],1,i-n+1])}else if(s[1]===o[i+1][1]){for(;i+1<o[t(137)]&&s[1]===o[i+1][1];)i++;h[t(157)]([s[0],s[1],i-n+1,1])}else h.push([s[0],s[1],1,1]);n=i}n===o[t(137)]-1&&h[t(157)]([o[n][0],o[n][1],1,1]);let r=0;for(const e of h){const o=Math.round(this._container[t(205)]/2)-i[t(251)]/2*s[t(136)]+s.x*s[t(136)],h=Math[t(102)](this[t(151)][t(196)]/2)-i[t(150)]/2*s[t(136)]+s.y*s.zoom,n=this._getOutlineElement(r++);n[t(120)][t(116)]=t(114),n[t(120)].left=o+e[0]*s[t(136)]-1+"px",n[t(120)].top=h+e[1]*s[t(136)]-1+"px",n.style[t(251)]=e[2]*s[t(136)]+"px",n[t(120)][t(150)]=e[3]*s.zoom+"px"}for(;r<this[t(236)][t(137)];r++)this[t(236)][r][t(120)][t(116)]="none"}[e(179)](t){const s=e;for(;t>=this[s(236)][s(137)];){const t=document.createElement(s(238));t[s(120)][s(153)]="absolute",t[s(197)].add(s(173)),this[s(236)].push(t),this._outlineElementContainer[s(166)](t)}return this[s(236)][t]}[e(107)](t,s,i,o){const h=e;return Math[h(231)](o-s)<Math.abs(i-t)?t>i?this[h(127)](i,o,t,s):this[h(127)](t,s,i,o):s>o?this._getLineHigh(i,o,t,s):this[h(217)](t,s,i,o)}_getLineLow(t,s,i,o){const h=e,n=[],r=i-t;let l=o-s,c=1;l<0&&(c=-1,l=-l);let a=2*l-r,d=s;for(let s=t;s<=i;s++)n[h(157)]([s,d]),a>0?(d+=c,a+=2*(l-r)):a+=2*l;return n}[e(217)](t,s,i,o){const h=e,n=[];let r=i-t;const l=o-s;let c=1;r<0&&(c=-1,r=-r);let a=2*r-l,d=t;for(let t=s;t<=o;t++)n[h(157)]([d,t]),a>0?(d+=c,a+=2*(r-l)):a+=2*r;return n}}class c{constructor(){this.isValid=!1,this.x1=0,this.y1=0,this.x2=0,this.y2=0}}var a=i(9904);class d extends h.JT{constructor(t){const s=e;super(),this._sc=t,this.id=s(181),this[s(191)]=[],this._cursorCoord=[0,0],this[s(126)]=!1,this._isShiftDown=!1,this._outlineModel=new c,this[s(247)]=new a.Jp,this.options=[this._blendModeOption],this[s(145)]=this.register(new o.v),this[s(124)]=this._onRequestRender[s(220)],this[s(113)]={x:0,y:0,text:"",isVisible:!1},this[s(190)](this[s(161)].historyService[s(140)]((t=>{const i=s;t[i(223)]===i(237)&&this._sc[i(160)].activeEntry?.[i(223)]===i(237)?this[i(191)]?.pop():this[i(191)].length=0}))),this.register(this[s(161)].historyService.onRedo((()=>this._lastUpCoords[s(137)]=0))),this[s(161)][s(192)].onUpdate((()=>{const t=s;this._outlineModel[t(172)]=!1,this[t(174)]()}))}[e(159)](t){const s=e;return[new n(t,this._cursorInfo),new l(t,this._sc[s(212)],this[s(161)][s(192)],this[s(155)])]}[e(142)](t){const s=e;this._isPointerDown=!0;const i=this._sc[s(212)];if(!i[s(149)])return;if(this._color=this[s(161)][s(148)][s(169)](t),!this[s(249)])return;const o=this[s(161)].viewportService.getCoordsFromEvent(t);if(o){if(t[s(246)]&&this._lastUpCoords[s(137)]>0){const t=this[s(191)][this[s(191)].length-1];this[s(180)]=t,this[s(130)](t,o,this[s(249)]),this[s(180)]=void 0}if(i.containsCoord(o[0],o[1])){const t=this._getEdit();this[s(121)](this._getEdit(),o[0],o[1],this[s(249)]),t[s(221)]()}this[s(132)]=o}}pointerDownMove(t){const s=e;if(!this[s(132)]||!this[s(249)])return;const i=this[s(161)][s(212)];if(!i[s(149)])return;const o=this[s(161)][s(192)].getCoordsFromEvent(t);this[s(132)][0]===o[0]&&this[s(132)][1]===o[1]||((i[s(206)](o[0],o[1])||i[s(206)](this[s(132)][0],this[s(132)][1]))&&this[s(130)](this[s(132)],o,this[s(249)]),this._lastDownCoord=o)}async[e(162)](t){const s=e;this._isPointerDown=!1,this[s(161)].imageService[s(149)]&&(this._edit?.[s(164)](s(237)),this[s(189)]=void 0);const i=this[s(161)][s(192)].getCoordsFromEvent(t);this[s(191)].push(i),this._updateOutline(t,!0)}async[e(118)](t){const s=e;this._cursorInfo.x=t[s(144)],this[s(113)].y=t.offsetY,this[s(158)]=this[s(161)][s(192)][s(241)](t),this[s(185)](t),!this._isPointerDown&&t.shiftKey?this[s(138)]():this._cursorInfo[s(143)]&&this[s(174)]()}keyDown(t){const s=e;!this._isShiftDown&&t[s(246)]&&(this[s(152)]=!0,!this[s(126)]&&(this[s(138)](),this[s(185)](t,!0)))}[e(188)](t){const s=e;!t[s(246)]&&(this[s(155)][s(172)]=!1,this[s(145)][s(131)](),this[s(113)][s(143)]&&this[s(174)](),this._isShiftDown=!1)}[e(185)](t,s){const i=e;if(s||this._outlineModel.x1!==this[i(158)][0]||this[i(155)].y1!==this[i(158)][1]){if(this._outlineModel.x1=this[i(158)][0],this._outlineModel.y1=this[i(158)][1],!this[i(126)]&&t[i(246)]&&this[i(191)].length>0){const t=this[i(191)][this[i(191)].length-1];this[i(155)].x2=t[0],this._outlineModel.y2=t[1],this[i(155)][i(172)]=!0}else this[i(155)].x2=this._cursorCoord[0],this[i(155)].y2=this[i(158)][1],this[i(155)][i(172)]=this[i(161)][i(212)][i(206)](this[i(155)].x1,this._outlineModel.y1);this[i(145)][i(131)]()}}[e(138)](){const t=e;if(0===this._lastUpCoords[t(137)])return;if(!this._cursorCoord)return;const s=this[t(191)][this[t(191)][t(137)]-1];if(s[0]===this[t(158)][0]&&s[1]===this._cursorCoord[1])return;let i=180*-Math.atan2(this[t(158)][1]-s[1],this[t(158)][0]-s[0])/Math.PI;-180===i&&(i=180),i=Math.round(10*i)/10,this[t(113)].text=i+"Â°",this[t(113)][t(143)]=!0,this[t(145)][t(131)]()}[e(174)](){const t=e;this._cursorInfo[t(143)]=!1,this[t(145)][t(131)]()}[e(130)](t,s,i){const o=e,h=this._getEdit();this._plotLine(h,i,t[0],t[1],s[0],s[1]),h[o(221)]()}[e(207)](){const t=e;if(!this[t(189)]&&(this[t(189)]=this[t(161)].imageService[t(149)]?.[t(156)](),!this[t(189)]))throw new Error("Could not create extended edit");return this[t(189)]}[e(228)](t,s,i,o,h,n){const r=e;Math[r(231)](n-o)<Math[r(231)](h-i)?i>h?this[r(165)](t,s,h,n,i,o):this[r(165)](t,s,i,o,h,n):o>n?this[r(227)](t,s,h,n,i,o):this._plotLineHigh(t,s,i,o,h,n)}_plotLineLow(t,s,i,o,h,n){const r=e,l=h-i;let c=n-o,a=1;c<0&&(a=-1,c=-c);let d=2*c-l,_=o;for(let e=i;e<=h;e++)this[r(121)](t,e,_,s),d>0?(_+=a,d+=2*(c-l)):d+=2*c}_plotLineHigh(t,s,i,o,h,n){const r=e;let l=h-i;const c=n-o;let a=1;l<0&&(a=-1,l=-l);let d=2*l-c,_=i;for(let i=o;i<=n;i++)this[r(121)](t,_,i,s),d>0?(_+=a,d+=2*(l-c)):d+=2*l}[e(121)](t,s,i,o){const h=e;this[h(180)]&&this[h(180)][0]===s&&this._ignoreSetPixel[1]===i||this[h(161)].selectionService[h(206)](s,i)&&this[h(161)][h(212)].containsCoord(s,i)&&t.setPixel(s,i,o,this._blendModeOption.value===h(199)?void 0:this[h(247)][h(106)])}}const _=d},1674:(t,s,i)=>{"use strict";const e=a11_0x30b744;i.d(s,{q:()=>o});const o=e(208)}}]);